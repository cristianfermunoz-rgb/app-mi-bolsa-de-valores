<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Over Gold - Cristian</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: sans-serif; background: #0b121d; color: white; padding: 15px; margin: 0; text-align: center; }
        .container { max-width: 1000px; margin: auto; }
        h1 { color: #facc15; font-size: 2.5em; margin: 10px 0; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; }
        .card { background: #161b22; padding: 15px; border-radius: 15px; border: 1px solid #333; text-align: left; }
        .valor { font-size: 1.8em; font-weight: bold; color: #facc15; margin: 5px 0; }
        .analisis { padding: 4px 10px; border-radius: 5px; font-size: 0.75em; font-weight: bold; display: inline-block; margin-bottom: 10px; }
        .buy { background: #064e3b; color: #10b981; }
        .wait { background: #422006; color: #f59e0b; }
        canvas { width: 100% !important; height: 160px !important; }
        button { background: #facc15; color: black; border: none; padding: 12px 20px; border-radius: 8px; font-weight: bold; cursor: pointer; margin: 15px 0; width: 100%; max-width: 300px; }
    </style>
</head>
<body>

<div class="container">
    <h1>OVER GOLD</h1>
    <button onclick="actualizarTodo()">ðŸ”„ Sincronizar Mercados</button>

    <div class="grid">
        <div class="card">
            <div id="a-nvda" class="analisis wait">Analizando...</div>
            <div style="color: #888;">Nvidia (NVDA)</div>
            <div id="p-nvda" class="valor">Cargando...</div>
            <canvas id="chart-nvda"></canvas>
        </div>
        <div class="card">
            <div id="a-oro" class="analisis wait">Analizando...</div>
            <div style="color: #888;">Oro (USD)</div>
            <div id="p-oro" class="valor">Cargando...</div>
            <canvas id="chart-oro"></canvas>
        </div>
        <div class="card">
            <div id="a-pet" class="analisis wait">Analizando...</div>
            <div style="color: #888;">PetrÃ³leo (COP)</div>
            <div id="p-pet" class="valor">Cargando...</div>
            <canvas id="chart-pet"></canvas>
        </div>
    </div>
</div>

<audio id="audio" src="https://www.soundjay.com/misc/sounds/cash-register-05.mp3"></audio>

<script>
const KEY = 'HOBELI497HGCKGJ6';

async function pedir(url) {
    try {
        const res = await fetch(url);
        return await res.json();
    } catch(e) { return null; }
}

function graficar(id, datos, color) {
    new Chart(document.getElementById(id), {
        type: 'line',
        data: {
            labels: [1,2,3,4,5],
            datasets: [{ data: datos, borderColor: color, tension: 0.3, fill: false }]
        },
        options: {
            scales: { x: { display: true, ticks: {color:'#555'}}, y: { display: true, ticks: {color:'#555'}}},
            plugins: { legend: { display: false }}
        }
    });
}

async function actualizarTodo() {
    // Nvidia
    const n = await pedir(`https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=NVDA&apikey=${KEY}`);
    if(n && n['Global Quote']) {
        const p = parseFloat(n['Global Quote']['05. price']);
        document.getElementById('p-nvda').innerText = "$" + p.toFixed(2);
        if(parseFloat(n['Global Quote']['10. change percent']) < 0) {
            document.getElementById('a-nvda').innerText = "BUEN MOMENTO";
            document.getElementById('a-nvda').className = "analisis buy";
            document.getElementById('audio').play();
        }
        graficar('chart-nvda', [p*1.02, p*0.97, p*1.01, p*0.99, p], '#10b981');
    }

    // Oro
    const o = await pedir(`https://www.alphavantage.co/query?function=GOLD&interval=monthly&apikey=${KEY}`);
    if(o && o.data) {
        const po = parseFloat(o.data[0].value);
        document.getElementById('p-oro').innerText = "$" + po.toFixed(2);
        graficar('chart-oro', o.data.slice(0,5).map(d => d.value).reverse(), '#facc15');
    }
}
actualizarTodo();
</script>
</body>
</html>
